max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5)
C3 = max_likelihood$par
}
C0
minus_loglikelihood_function(1,1,1,1,1,1)
minus_loglikelihood_function(1,1,1,1.3,1.4,1.5)
minus_loglikelihood_function(1,1,1,1,1.4,1.5)
minus_loglikelihood_function(1,1,1,1,1.4,1.5)
minus_loglikelihood_function(1.2,1.3,1,1,1,1)
minus_loglikelihood_function(1.2,1.3,1.4,1.5,1.6,1.7)
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:50) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5)
C3 = max_likelihood$par
}
C0
sum(WaveletCoefficientMatrix)
grid
nsubject
minus_loglikelihood_function = function(C0, C1, C2, C3,
C4, C5, nsubject, grid, WaveletCoefficientMatrix) {
aux = 0
for (subject in c(1:nsubject)) for (l in c(0:(log2(grid) -
1))) for (j in c(1:(2^(2 * l) * 3))) {
if (l == 0)
d = WaveletCoefficientMatrix[subject, j]
else d = WaveletCoefficientMatrix[subject, sum(2^(2 *
(0:(l - 1))) * 3) + j]
a.l = C0 * 2^(-C1 * l)
b.l = C2 * 2^(-C3 * l)
expect.w = min(1, a.l/(a.l + b.l))
c.l = C4 * 2^(-C5 * l)
if (abs(d) <= 39.6)
aux1 = log(exp(log(expect.w * (1 + c.l)^(-0.5)) -
0.5 * (d^2)/(1 + c.l)) + exp(log(1 - expect.w) -
0.5 * (d^2)))
else aux1 = log(exp(log(expect.w * (1 + c.l)^(-0.5)) -
0.5 * (39.6^2)/(1 + c.l)) + exp(log(1 - expect.w) -
0.5 * (39.6^2)))
aux = aux + aux1
}
-aux
}
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:50) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
}
C0
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
C0
C1
C2
C3
C4
C5
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:10) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
}
c((C0, C1, C2, C3, C4, C5))
c(C0, C1, C2, C3, C4, C5)
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:1) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
}
c(C0, C1, C2, C3, C4, C5)
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:2) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
}
c(C0, C1, C2, C3, C4, C5)
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:5) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
}
c(C0, C1, C2, C3, C4, C5)
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:3) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
}
c(C0, C1, C2, C3, C4, C5)
.Machine$double.eps
.Machine$double.eps=2.220446e-30
.Machine$double.eps
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:3) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
}
c(C0, C1, C2, C3, C4, C5)
typeof(1)
typeof(1L)
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:2) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
}
c(C0, C1, C2, C3, C4, C5)
sum(c(C0, C1, C2, C3, C4, C5))
typeof(C0)
round(C0,8)
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
c(C0, C1, C2, C3, C4, C5)
C0 = 1
C1 = 1
C2 = 1
C3 = 1
C4 = 1
C5 = 1
for (i in 1:2) {
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
}
c(C0, C1, C2, C3, C4, C5)
C0=round(C0,6);C1=round(C1,6);C2=round(C2,6);C3=round(C3,6);C4=round(C4,6);C5=round(C5,6)
c(C0, C1, C2, C3, C4, C5)
max_likelihood = nlminb(start = C5, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C4 = C4, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C5 = max_likelihood$par
max_likelihood = nlminb(start = C4, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C2 = C2,
C3 = C3, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C4 = max_likelihood$par
max_likelihood = nlminb(start = C0, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C1 = C1, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C0 = max_likelihood$par
max_likelihood = nlminb(start = C1, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C2 = C2, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C1 = max_likelihood$par
max_likelihood = nlminb(start = C2, objective = minus_loglikelihood_function,
lower = 0, upper = Inf, C0 = C0, C1 = C1, C3 = C3,
C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C2 = max_likelihood$par
max_likelihood = nlminb(start = C3, objective = minus_loglikelihood_function,
lower = -Inf, upper = Inf, C0 = C0, C1 = C1,
C2 = C2, C4 = C4, C5 = C5, nsubject=nsubject, grid=grid, WaveletCoefficientMatrix=WaveletCoefficientMatrix)
C3 = max_likelihood$par
c(C0, C1, C2, C3, C4, C5)
diag(2)
diag(2)[1,]
diag(2)[1,,drop=F]
library(BHMSMAfMRI)
set.seed(1)
nsubject <- 3
grid <- 8
ntime <- 4
Data <- array(rnorm(3*8*8*4),dim=c(3,8,8,4))
DesignMatrix <- cbind(c(1,0,1,0), c(1,1,1,1))
analysis <- "multi"
BHMSMA.multi <- BHMSMA(nsubject, grid, Data, DesignMatrix, TrueCoeff=NULL, analysis)
sum(BHMSMAmulti$GLMCoeffStandardized)
sum(BHMSMA.multi$GLMCoeffStandardized)
BHMSMA.multi$hyperparam
sum(BHMSMA.multi$WaveletCoefficientMatrix)
sum(BHMSMA.multi$GLMcoeffposterior)
dim(BHMSMA.multi$GLMcoeffposterior)
sum(BHMSMA.multi$GLMcoeffposterior)
remove.packages("BHMSMAfMRI1")
??CGEN
install.packages("pkgdown")
library(pkgdown)
?pkgdown
help(package="pkgdown")
usethis::use_pkgdown()
library(pkgdown)
usethis::use_pkgdown()
install.packages("usethis")
install.packages("usethis")
usethis::use_pkgdown()
setwd("/Users/nsanyal/Dropbox/Statistics/Research_Nil/Project-01-fMRI/R_package/Version_2.0/BHMSMAfMRI1")
usethis::use_pkgdown()
pkgdown::build_site()
citation("BHMSMAfMRI")
remove.packages(BHMSMAfMRI)
remove.packages("BHMSMAfMRI")
remove.packages("BHMSMAfMRI1")
